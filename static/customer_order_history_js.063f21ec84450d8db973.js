!function(t){var e={};function s(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/assets/",s(s.s=63)}({0:function(t,e,s){"use strict";s.d(e,"b",function(){return n}),s.d(e,"a",function(){return r});const n="http://localhost:5000",r=`${n}/api/v1`},1:function(t,e,s){"use strict";e.a=class{constructor(t){this._state={status:t.status},this._props=t;let e=document.createElement("button");e.setAttribute("type","button"),e.classList.add(t.textClass),e.classList.add(this.getButtonClass(t.class,t.status)),e.innerHTML=t.label,e.addEventListener("click",t.action),this._component={main:e}}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}get props(){return this._props}set props(t){this._props=t}getButton(){return this.component.main}init(){let t=this.props.parent.state;t.buttons.push(this),this.props.parent.state=t}setStatus(t,e=3e3){let s=this.state,n=this.component,r=this.props,a=this,o=this.getButtonClass(r.class,s.status),i=this.getButtonClass(r.class,t);n.main.classList.replace(o,i),1==t||2==t?setTimeout(()=>{let e=this.getButtonClass(r.class,t),o=this.getButtonClass(r.class,r.status);n.main.classList.replace(e,o),s.status=r.status,a.state=s},e):(s.status=t,a.state=s)}getButtonClass(t,e){switch(e){case 0:return`${t}`;case 1:case 5:return`${t}--fail`;case 2:case 6:return`${t}--success`;case 3:return`${t}--loading`;case 4:return`${t}--warning`}}}},12:function(t,e,s){"use strict";var n=s(13),r=s(0),a=s(2);class o{constructor(t){let e=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");s.classList.add("order__item__name"),s.classList.add("f_normal"),s.innerHTML=t.item.name,n.classList.add("order__item__quantity"),n.classList.add("f_normal"),n.innerHTML=t.item.quantity,r.classList.add("order__item__price"),r.classList.add("f_normal"),r.innerHTML=`KSH ${t.item.price/100}`,e.classList.add("order__item"),e.appendChild(s),e.appendChild(n),e.appendChild(r),this._components={main:e,orderedItemName:s,orderedItemQuantity:n,orderedItemPrice:r};let a=t.parent.state;a.orderedItems.push(this),t.parent.state=a}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}getOrderedItem(){return this.components.main}}e.a=class{constructor(t){t.onStatusUpdateSuccess=void 0==t.onStatusUpdateSuccess?()=>{}:t.onStatusUpdateSuccess,this._state={order:t.order,orderedItems:[],dropdownButtons:[],access:void 0==t.access?"customer":"admin"};let e=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),c=document.createElement("div");n.classList.add("order__id"),n.classList.add("f_normal"),n.innerHTML=t.order.id,r.classList.add("order__items"),a.classList.add("order__total"),a.classList.add("f_normal"),a.innerHTML=`KSH ${t.order.total/100}`,o.classList.add("order__time"),o.classList.add("f_normal"),o.innerHTML=t.order.created_at;let d=this.getOrderStatus(t.order.status);i.classList.add(d.class),i.classList.add("f_normal"),i.innerHTML=d.text,c.classList.add("order__statusButtons"),s.classList.add("order__details"),s.appendChild(n),s.appendChild(a),s.appendChild(o),s.appendChild(i),s.appendChild(r),e.classList.add("order"),e.appendChild(s),e.appendChild(c),this._components={main:e,orderId:n,orderItemsList:r,orderTotal:a,orderTime:o,orderStatus:i,orderStatusButtons:c};let u=t.parent.state;u.orders.push(this),t.parent.state=u,this._props=t,this.populateOrderedItemsList(),this.setOrderStatusButtons()}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}get props(){return this._props}set props(t){this._props=t}populateOrderedItemsList(){let t=this.state.order.items,e=this.components.orderItemsList,s=this;t.forEach(t=>{let n=new o({item:t,parent:s});e.appendChild(n.getOrderedItem())})}setOrderStatusButtons(){if("admin"==this.state.access){this.components.orderStatusButtons.innerHTML="";let t=[],e=this;switch(this.state.order.status){case 0:t=[{name:"Process",action:()=>{e.setNewOrderStatus(1)}},{name:"Cancel",action:()=>{e.setNewOrderStatus(2)}}];break;case 1:t=[{name:"Complete",action:()=>{e.setNewOrderStatus(3)}}];break;case 2:case 3:return}let s=new n.a({class:"ddButtons",textClass:"f_button_2",label:"Set as",parent:this,buttons:t});this.components.orderStatusButtons.appendChild(s.getDropDownButtonsComponent())}}setOrderStatus(t){let e=this.getOrderStatus(this.state.order.status),s=this.getOrderStatus(t),n=this.components.orderStatus;n.classList.replace(e.class,s.class),n.innerHTML=s.text,this.state.order.status=t,this.setOrderStatusButtons()}getOrderStatus(t){switch(t){case 0:return{class:"order__status--pending",text:"Pending"};case 1:return{class:"order__status--processing",text:"Processing"};case 2:return{class:"order__status--cancelled",text:"Cancelled"};case 3:return{class:"order__status--complete",text:"Complete"}}}getOrderComponent(){return this.components.main}setNewOrderStatus(t){let e=this,s=`${r.a}/order/${this.state.order.id}`;this.state.dropdownButtons[0].setStatus(3),fetch(s,{method:"PUT",body:JSON.stringify({status:t}),headers:{Authorization:`Bearer ${Object(a.a)()}`,"Content-Type":"application/json"}}).then(s=>{switch(s.status){case 200:return s.json();case 401:e.state.dropdownButtons[0].setStatus(1),Object(a.b)({onSuccess:()=>{e.setNewOrderStatus(t)},onFailure:()=>{window.location.href=r.b+"/admin/login"}})}}).then(s=>{void 0!=s&&(e.state.dropdownButtons[0].setStatus(2),e.setOrderStatus(t),e.props.onStatusUpdateSuccess())})}}},13:function(t,e,s){"use strict";var n=s(1);e.a=class{constructor(t){this._state={toggle:!1,buttons:[]};let e=this,s=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),o=new n.a({class:`${t.class}__main__button`,textClass:t.textClass,status:0,label:t.label,parent:e,action:()=>{e.toggleButtonOptions()}});o.init(),r.classList.add(`${t.class}__main`),r.appendChild(o.getButton()),a.classList.add(`${t.class}__buttons--disabled`),t.buttons.forEach(s=>{let r=new n.a({class:`${t.class}__button`,textClass:t.textClass,status:0,label:s.name,parent:e,action:()=>{s.action()}});r.init(),a.appendChild(r.getButton())}),s.classList.add(`${t.class}`),s.appendChild(r),s.appendChild(a),this._components={main:s,ddMainButton:r,ddButtons:a},this._props=t,t.parent.state.dropdownButtons.push(this)}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}get props(){return this._props}set props(t){this._props=t}getDropDownButtonsComponent(){return this.components.main}toggleButtonOptions(){let t=this.state;t.toggle?(this.components.ddButtons.classList.replace(`${this.props.class}__buttons--active`,`${this.props.class}__buttons--disabled`),t.toggle=!1):(this.components.ddButtons.classList.replace(`${this.props.class}__buttons--disabled`,`${this.props.class}__buttons--active`),t.toggle=!0),this.state=t}getButtonClass(t,e){switch(e){case 0:return`${t}`;case 1:return`${t}--fail`;case 2:return`${t}--success`;case 3:return`${t}--loading`;case 4:return`${t}--warning`}}setStatus(t,e=3e3){let s=this.state,n=this.components,r=this.props,a=this,o=`${this.props.class}__main`,i=this.getButtonClass(o,s.status),c=this.getButtonClass(o,t);n.ddMainButton.classList.replace(i,c),1==t||2==t?setTimeout(()=>{let e=this.getButtonClass(o,t),i=this.getButtonClass(o,r.status);n.main.classList.replace(e,i),s.status=r.status,a.state=s},e):(s.status=t,a.state=s)}}},2:function(t,e,s){"use strict";s.d(e,"b",function(){return r}),s.d(e,"a",function(){return a});var n=s(0);function r(t){let e=JSON.parse(localStorage.getItem("tokens"));fetch(`${n.a}/token/refresh`,{method:"GET",headers:{Authorization:`Bearer ${e.refresh_token}`}}).then(e=>{if(201==e.status)return e.json();t.onFailure()}).then(s=>{void 0!=s&&(e.access_token=s.access_token,localStorage.setItem("tokens",JSON.stringify(e)),t.onSuccess())})}function a(){return JSON.parse(localStorage.getItem("tokens")).access_token}},63:function(t,e,s){t.exports=s(64)},64:function(t,e,s){"use strict";s.r(e);var n=s(0),r=s(2),a=s(12);class o{constructor(){this._state={orders:[]},this._components={}}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}init(){let t=document.querySelector(".orderHistory__content");this.components.orderHistoryContent=t}populateOrderHistory(t){let e=this,s=this.components.orderHistoryContent;t.orders.reverse().forEach(n=>{n.items.forEach(e=>{let s=t.menu.find(t=>t.id==e.item);void 0!=s&&(e.name=s.name,e.price=s.price,e.c_id=s.c_id)});let r=new a.a({parent:e,order:n});s.appendChild(r.getOrderComponent())})}fetchOrderHistory(){let t=this;fetch(`${n.a}/users/orders`,{method:"GET",headers:{Authorization:`Bearer ${Object(r.a)()}`}}).then(e=>{switch(e.status){case 200:return e.json();case 401:Object(r.b)({onSuccess:()=>{t.fetchOrderHistory()},onFailure:()=>{window.location.href=n.b+"/customer/login"}})}}).then(e=>{void 0!=e&&t.populateOrderHistory(e.content)})}}let i=new o;document.addEventListener("DOMContentLoaded",()=>{i.init(),i.fetchOrderHistory()}),e.default=o}});