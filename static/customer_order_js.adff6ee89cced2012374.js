!function(e){var t={};function n(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/assets/",n(n.s=184)}({1:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return a});const s="https://fast-food-fast-bb.herokuapp.com",a=`${s}/api/v1`},10:function(e,t,n){"use strict";n.r(t);var s=n(7),a=n.n(s),o=n(4),r=n.n(o),i=n(3),d=n(2),c=n(1),u=n(9),l=n.n(u);t.default=class{constructor(e={}){this._state={headerType:void 0==e.type?"black":e.type,buttons:[],toggleMenu:!1},this._components={}}get state(){return this._state}set state(e){this._state=e}get components(){return this._components}set components(e){this._components=e}init(){let e=this,t=document.querySelector(".header__logout"),n=document.querySelector(".header__menuButton"),s=document.querySelector(".header__dropDownMenu--disabled"),a=new i.a({class:"btn_1",textClass:"f_button_1",label:"Log Out",parent:e,status:0,action:()=>{e.logOut()}});a.init(),t.appendChild(a.getButton());let o=new Image;o.src=l.a,o.alt="Dropdown menu button",n.appendChild(o),n.addEventListener("click",()=>{e.toggleDropDownMenu()}),this.changeHeaderType(this.state.headerType),this.components.headerMenuButton=n,this.components.headerDropDownMenu=s}changeHeaderType(){let e=document.querySelector(".header__logo"),t=new Image;switch(t.alt="FastFoodFast Logo",this.state.headerType){case"black":t.src=a.a;break;case"white":t.src=r.a}e.appendChild(t)}toggleDropDownMenu(){this.state.toggleMenu=!this.state.toggleMenu,this.state.toggleMenu?(document.querySelector(".header__dropDownMenu__logOut").appendChild(this.state.buttons[0].getButton()),this.components.headerDropDownMenu.classList.replace("header__dropDownMenu--disabled","header__dropDownMenu--active")):(document.querySelector(".header__logOut").appendChild(this.state.buttons[0].getButton()),this.components.headerDropDownMenu.classList.replace("header__dropDownMenu--active","header__dropDownMenu--disabled"))}logOut(){let e=this;fetch(`${c.a}/auth/logout`,{headers:{Authorization:`Bearer ${Object(d.a)()}`}}).then(t=>{switch(t.status){case 200:localStorage.setItem("tokens",JSON.stringify({})),window.location.href=c.b+"/";break;case 401:Object(d.b)({onSuccess:()=>{e.logOut()},onFailure:()=>{window.location.href=c.b+"/customer/login"}});break;case 422:window.location.href=c.b+"/customer/login"}})}}},134:function(e,t,n){e.exports=n.p+"d47c0b2480371f5b5261e25f5938755a.png"},135:function(e,t,n){e.exports=n.p+"d5d9e2b9c600ebcd4e98640b15ed2b0f.png"},136:function(e,t,n){e.exports=n.p+"75bb1dfba7409341bee1f971a19e88cd.png"},137:function(e,t,n){e.exports=n.p+"e707c04257c1833ee8e26bc0499e4256.png"},143:function(e,t,n){"use strict";var s=n(134),a=n.n(s),o=n(135),r=n.n(o),i=n(136),d=n.n(i),c=n(137),u=n.n(c);t.a=class{constructor(e){this._state={total:0,quantity:0,item:e.item};let t=this,n=document.createElement("div"),s=document.createElement("div"),o=new Image,i=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),p=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");switch(e.item.c_id){case 1:o.src=a.a;break;case 2:o.src=r.a;break;case 3:o.src=d.a;break;case 4:o.src=u.a}o.alt=e.item.name,s.classList.add("foodItem__image"),s.appendChild(o),i.classList.add("foodItem__name"),i.classList.add("f_normal"),i.innerHTML=e.item.name,c.classList.add("foodItem__price"),c.classList.add("f_normal"),c.innerHTML="KSH "+e.item.price/100,l.classList.add("foodItem__quantity"),h.classList.add("foodItem__quantity__add"),h.innerHTML="+",p.classList.add("foodItem__quantity__sub"),p.innerHTML="-",m.classList.add("foodItem__quantity__value"),m.classList.add("f_normal"),m.innerHTML="0",h.addEventListener("click",()=>{t.updateQuantity(1,!0),e.onUpdate()}),p.addEventListener("click",()=>{t.updateQuantity(1,!1),e.onUpdate()}),l.appendChild(h),l.appendChild(m),l.appendChild(p),f.classList.add("foodItem__total"),f.classList.add("f_normal"),f.innerHTML="KSH 0",n.classList.add("foodItem"),n.appendChild(s),n.appendChild(i),n.appendChild(c),n.appendChild(l),n.appendChild(f),this._component={main:n,itemImage:s,itemImageImg:o,itemName:i,itemPrice:c,itemQuantity:l,itemQuantityAdd:h,itemQuantitySub:p,itemQuantityValue:m,itemTotal:f};let _=e.parent.state;_.orderItems.push(this),e.parent.state=_}get state(){return this._state}set state(e){this._state=e}get component(){return this._component}set component(e){this._component=e}updateQuantity(e=1,t=!0){let n=this.state;if(console.log("Updating order : "+n.item.name),t)n.quantity+=e,n.total+=n.item.price;else{if(0==n.quantity)return;n.quantity-=e,n.total-=n.item.price}this.state=n,this.updateOrderDisplay()}updateOrderDisplay(){let e=this.component;e.itemQuantityValue.innerHTML=""+this.state.quantity,e.itemTotal.innerHTML="KSH "+this.state.total/100}getOrderItem(){return this.component.main}}},184:function(e,t,n){e.exports=n(185)},185:function(e,t,n){"use strict";n.r(t);var s=n(143),a=n(3),o=n(1),r=n(2),i=n(10);class d{constructor(){this._state={orderItems:[],buttons:[],total:0};let e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),p=this;s.classList.add("foodMenu__title"),s.classList.add("f_h1"),s.innerHTML="Order Menu",n.classList.add("foodMenu__topBar"),n.appendChild(s),t.classList.add("foodMenu__content"),r.classList.add("foodMenu__error"),r.classList.add("errorComment--disabled"),r.classList.add("f_comment_1");let m=new a.a({class:"btn_1",textClass:"f_button_2",label:"Make order",parent:this,status:0,action:()=>{p.makeOrder()}});m.init(),i.classList.add("foodMenu__orderBtn"),i.appendChild(m.getButton()),d.classList.add("foodMenu__total"),d.classList.add("f_normal"),d.innerHTML="KSH 0",o.classList.add("foodMenu__bottom"),o.appendChild(i),o.appendChild(d),c.classList.add("foodMenu__category"),c.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>',h.classList.add("foodMenu__category"),h.innerHTML='<h2 class="f_h2">Main Meals</h2>',u.classList.add("foodMenu__category"),u.innerHTML='<h2 class="f_h2">Snacks</h2>',l.classList.add("foodMenu__category"),l.innerHTML='<h2 class="f_h2">Drinks</h2>',t.appendChild(c),t.appendChild(h),t.appendChild(u),t.appendChild(l),e.appendChild(n),e.appendChild(t),e.appendChild(r),e.appendChild(o),this._components={main:e,orderMenuContent:t,orderMenuTopbar:n,orderMenuError:r,orderMenuTitle:s,orderMenuBottom:o,orderMenuOrderButton:i,orderMenuTotal:d,orderMenuCategoryBreakfast:c,orderMenuCategorySnacks:u,orderMenuCategoryDrinks:l,orderMenuCategoryMain:h}}get state(){return this._state}set state(e){this._state=e}get components(){return this._components}set components(e){this._components=e}init(){document.querySelector(".foodMenu").appendChild(this.components.main)}displayError(e,t=3e3){let n=this.components.orderMenuError;n.innerHTML=e,n.classList.replace("errorComment--disabled","errorComment--active"),setTimeout(()=>{n.innerHTML="",n.classList.replace("errorComment--active","errorComment--disabled")},t)}setMenuError(e){let t=this.components,n=`<div class="foodMenu__content__error f_h1">${e}</div>`;t.orderMenuCategoryBreakfast.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>'+n,t.orderMenuCategoryMain.innerHTML='<h2 class="f_h2">Main Meals</h2>'+n,t.orderMenuCategorySnacks.innerHTML='<h2 class="f_h2">Snacks</h2>'+n,t.orderMenuCategoryDrinks.innerHTML='<h2 class="f_h2">Drinks</h2>'+n,this.components=t}updateOrderMenu(e){let t=this,n=[[],[],[],[]];if(0==e.length)return void this.setMenuError("No items in this category. Please add something!");e.forEach(e=>{let a=new s.a({item:e,parent:t,onUpdate:()=>{t.updateOrder()}});n[e.c_id-1].push(a.getOrderItem())});let a='<div class="foodMenu__content__error f_h2">No items in this category.</div>';0==n[0].length?this.components.orderMenuCategoryBreakfast.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>'+a:n[0].forEach(e=>{this.components.orderMenuCategoryBreakfast.appendChild(e)}),0==n[1].length?this.components.orderMenuCategoryMain.innerHTML='<h2 class="f_h2">Main Meals</h2>'+a:n[1].forEach(e=>{this.components.orderMenuCategoryMain.appendChild(e)}),0==n[2].length?this.components.orderMenuCategorySnacks.innerHTML='<h2 class="f_h2">Snacks</h2>'+a:n[2].forEach(e=>{this.components.orderMenuCategorySnacks.appendChild(e)}),0==n[3].length?this.components.orderMenuCategoryDrinks.innerHTML='<h2 class="f_h2">Drinks</h2>'+a:n[3].forEach(e=>{this.components.orderMenuCategoryDrinks.appendChild(e)})}updateOrder(){let e=this.state;e.total=0,e.orderItems.forEach(t=>{0!=t.state.quantity&&(e.total+=t.state.total)}),this.components.orderMenuTotal.innerHTML="KSH "+e.total/100,this.state=e}fetchMenu(){let e=this;fetch(`${o.a}/menu`).then(t=>{if(200==t.status)return t.json();e.setMenuError("Failed to fetch menu. Please try again later!")}).then(t=>{void 0!=t&&e.updateOrderMenu(t.content)})}makeOrder(){let e=[];if(this.state.orderItems.forEach(t=>{0!=t.state.quantity&&e.push({id:t.state.item.id,quantity:t.state.quantity})}),0==e.length)return void this.displayError("You have not selected any items!");this.state.buttons[0].setStatus(3);let t=this;fetch(`${o.a}/users/orders`,{method:"post",body:JSON.stringify({items:JSON.stringify(e)}),headers:{Authorization:`Bearer ${Object(r.a)()}`,"Content-Type":"application/json"}}).then(e=>{if(201==e.status)return e.json();401==e.status?Object(r.b)({onSuccess:()=>{t.makeOrder()},onFailure:()=>{window.location.href=o.b+"/customer/login"}}):403==e&&(window.location.href=o.b+"/customer/login"),this.state.buttons[0].setStatus(1)}).then(e=>{void 0!=e&&(this.state.buttons[0].setStatus(2),window.location.href=o.b+"/customer/orderHistory")})}}let c=new d,u=new i.default;document.addEventListener("DOMContentLoaded",()=>{u.init(),c.init(),c.fetchMenu()}),t.default=d},2:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return o});var s=n(1);function a(e){let t=JSON.parse(localStorage.getItem("tokens"));fetch(`${s.a}/token/refresh`,{method:"GET",headers:{Authorization:`Bearer ${t.refresh_token}`}}).then(t=>{if(201==t.status)return t.json();e.onFailure()}).then(n=>{void 0!=n&&(t.access_token=n.access_token,localStorage.setItem("tokens",JSON.stringify(t)),e.onSuccess())})}function o(){let e=JSON.parse(localStorage.getItem("tokens"));return null==e?"":e.access_token}},3:function(e,t,n){"use strict";t.a=class{constructor(e){this._state={status:e.status},this._props=e;let t=document.createElement("button");t.setAttribute("type","button"),t.classList.add(e.textClass),t.classList.add(this.getButtonClass(e.class,e.status)),t.innerHTML=e.label,t.addEventListener("click",e.action),this._component={main:t}}get state(){return this._state}set state(e){this._state=e}get component(){return this._component}set component(e){this._component=e}get props(){return this._props}set props(e){this._props=e}getButton(){return this.component.main}init(){let e=this.props.parent.state;e.buttons.push(this),this.props.parent.state=e}setStatus(e,t=3e3){let n=this.state,s=this.component,a=this.props,o=this,r=this.getButtonClass(a.class,n.status),i=this.getButtonClass(a.class,e);s.main.classList.replace(r,i),1==e||2==e?setTimeout(()=>{let t=this.getButtonClass(a.class,e),r=this.getButtonClass(a.class,a.status);s.main.classList.replace(t,r),n.status=a.status,o.state=n},t):(n.status=e,o.state=n)}getButtonClass(e,t){switch(t){case 0:return`${e}`;case 1:case 5:return`${e}--fail`;case 2:case 6:return`${e}--success`;case 3:return`${e}--loading`;case 4:return`${e}--warning`}}}},4:function(e,t,n){e.exports=n.p+"4d13aad5b435a3e7bd5832e9199db4a5.png"},7:function(e,t,n){e.exports=n.p+"3e2d929931fcf869c79d01a08df4eddd.png"},9:function(e,t,n){e.exports=n.p+"b889e74d914d77a04de009eac356924d.png"}});