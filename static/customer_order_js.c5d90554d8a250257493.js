!function(t){var e={};function n(a){if(e[a])return e[a].exports;var s=e[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s=57)}({0:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return s});const a="http://localhost:5000",s=`${a}/api/v1`},1:function(t,e,n){"use strict";e.a=class{constructor(t){this._state={status:t.status},this._props=t;let e=document.createElement("button");e.setAttribute("type","button"),e.classList.add(t.textClass),e.classList.add(this.getButtonClass(t.class,t.status)),e.innerHTML=t.label,e.addEventListener("click",t.action),this._component={main:e}}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}get props(){return this._props}set props(t){this._props=t}getButton(){return this.component.main}init(){let t=this.props.parent.state;t.buttons.push(this),this.props.parent.state=t}setStatus(t,e=3e3){let n=this.state,a=this.component,s=this.props,r=this,o=this.getButtonClass(s.class,n.status),i=this.getButtonClass(s.class,t);a.main.classList.replace(o,i),1==t||2==t?setTimeout(()=>{let e=this.getButtonClass(s.class,t),o=this.getButtonClass(s.class,s.status);a.main.classList.replace(e,o),n.status=s.status,r.state=n},e):(n.status=t,r.state=n)}getButtonClass(t,e){switch(e){case 0:return`${t}`;case 1:case 5:return`${t}--fail`;case 2:case 6:return`${t}--success`;case 3:return`${t}--loading`;case 4:return`${t}--warning`}}}},10:function(t,e,n){t.exports=n.p+"75bb1dfba7409341bee1f971a19e88cd.png"},11:function(t,e,n){t.exports=n.p+"e707c04257c1833ee8e26bc0499e4256.png"},15:function(t,e,n){"use strict";n.r(e);var a=n(6),s=n.n(a),r=n(5),o=n.n(r),i=n(1),d=n(2),c=n(0);e.default=class{constructor(t={}){this._state={headerType:void 0==t.type?"black":t.type,buttons:[]},this._components={}}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}init(){let t=this,e=document.querySelector(".header__logout"),n=new i.a({class:"btn_1",textClass:"f_button_1",label:"Log Out",parent:t,status:0,action:()=>{t.logOut()}});n.init(),e.appendChild(n.getButton()),this.changeHeaderType(this.state.headerType)}changeHeaderType(){let t=document.querySelector(".header__logo"),e=new Image;switch(e.alt="FastFoodFast Logo",this.state.headerType){case"black":e.src=s.a;break;case"white":e.src=o.a}t.appendChild(e)}logOut(){let t=this;fetch(`${c.a}/auth/logout`,{headers:{Authorization:`Bearer ${Object(d.a)()}`}}).then(e=>{switch(e.status){case 200:localStorage.setItem("tokens",JSON.stringify({})),window.location.href=c.b+"/";break;case 401:Object(d.b)({onSuccess:()=>{t.logOut()},onFailure:()=>{window.location.href=c.b+"/customer/login"}});break;case 422:window.location.href=c.b+"/customer/login"}})}}},16:function(t,e,n){"use strict";var a=n(8),s=n.n(a),r=n(9),o=n.n(r),i=n(10),d=n.n(i),c=n(11),u=n.n(c);e.a=class{constructor(t){this._state={total:0,quantity:0,item:t.item};let e=this,n=document.createElement("div"),a=document.createElement("div"),r=new Image,i=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),p=document.createElement("div"),h=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");switch(t.item.c_id){case 1:r.src=s.a;break;case 2:r.src=o.a;break;case 3:r.src=d.a;break;case 4:r.src=u.a}r.alt=t.item.name,a.classList.add("foodItem__image"),a.appendChild(r),i.classList.add("foodItem__name"),i.classList.add("f_normal"),i.innerHTML=t.item.name,c.classList.add("foodItem__price"),c.classList.add("f_normal"),c.innerHTML="KSH "+t.item.price/100,l.classList.add("foodItem__quantity"),p.classList.add("foodItem__quantity__add"),p.innerHTML="+",h.classList.add("foodItem__quantity__sub"),h.innerHTML="-",m.classList.add("foodItem__quantity__value"),m.classList.add("f_normal"),m.innerHTML="0",p.addEventListener("click",()=>{e.updateQuantity(1,!0),t.onUpdate()}),h.addEventListener("click",()=>{e.updateQuantity(1,!1),t.onUpdate()}),l.appendChild(h),l.appendChild(m),l.appendChild(p),f.classList.add("foodItem__total"),f.classList.add("f_normal"),f.innerHTML="KSH 0",n.classList.add("foodItem"),n.appendChild(a),n.appendChild(i),n.appendChild(c),n.appendChild(l),n.appendChild(f),this._component={main:n,itemImage:a,itemImageImg:r,itemName:i,itemPrice:c,itemQuantity:l,itemQuantityAdd:p,itemQuantitySub:h,itemQuantityValue:m,itemTotal:f};let _=t.parent.state;_.orderItems.push(this),t.parent.state=_}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}updateQuantity(t=1,e=!0){let n=this.state;if(console.log("Updating order : "+n.item.name),e)n.quantity+=t,n.total+=n.item.price;else{if(0==n.quantity)return;n.quantity-=t,n.total-=n.item.price}this.state=n,this.updateOrderDisplay()}updateOrderDisplay(){let t=this.component;t.itemQuantityValue.innerHTML=""+this.state.quantity,t.itemTotal.innerHTML="KSH "+this.state.total/100}getOrderItem(){return this.component.main}}},2:function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return r});var a=n(0);function s(t){let e=JSON.parse(localStorage.getItem("tokens"));fetch(`${a.a}/token/refresh`,{method:"GET",headers:{Authorization:`Bearer ${e.refresh_token}`}}).then(e=>{if(201==e.status)return e.json();t.onFailure()}).then(n=>{void 0!=n&&(e.access_token=n.access_token,localStorage.setItem("tokens",JSON.stringify(e)),t.onSuccess())})}function r(){return JSON.parse(localStorage.getItem("tokens")).access_token}},5:function(t,e,n){t.exports=n.p+"4d13aad5b435a3e7bd5832e9199db4a5.png"},57:function(t,e,n){t.exports=n(58)},58:function(t,e,n){"use strict";n.r(e);var a=n(16),s=n(1),r=n(0),o=n(2),i=n(15);class d{constructor(){this._state={orderItems:[],buttons:[],total:0};let t=document.createElement("div"),e=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),l=document.createElement("div"),p=this;a.classList.add("foodMenu__title"),a.classList.add("f_h1"),a.innerHTML="Order Menu",n.classList.add("foodMenu__topBar"),n.appendChild(a),e.classList.add("foodMenu__content");let h=new s.a({class:"btn_1",textClass:"f_button_1",label:"Make order",parent:this,status:0,action:()=>{p.makeOrder()}});h.init(),o.classList.add("foodMenu__orderBtn"),o.appendChild(h.getButton()),i.classList.add("foodMenu__total"),i.classList.add("f_normal"),i.innerHTML="KSH 0",r.classList.add("foodMenu__bottom"),r.appendChild(o),r.appendChild(i),d.classList.add("foodMenu__category"),d.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>',l.classList.add("foodMenu__category"),l.innerHTML='<h2 class="f_h2">Main Meals</h2>',c.classList.add("foodMenu__category"),c.innerHTML='<h2 class="f_h2">Snacks</h2>',u.classList.add("foodMenu__category"),u.innerHTML='<h2 class="f_h2">Drinks</h2>',e.appendChild(d),e.appendChild(l),e.appendChild(c),e.appendChild(u),t.appendChild(n),t.appendChild(e),t.appendChild(r),this._components={main:t,orderMenuContent:e,orderMenuTopbar:n,orderMenuTitle:a,orderMenuBottom:r,orderMenuOrderButton:o,orderMenuTotal:i,orderMenuCategoryBreakfast:d,orderMenuCategorySnack:c,orderMenuCategoryDrinks:u,orderMenuCategoryMain:l}}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}init(){document.querySelector(".foodMenu").appendChild(this.components.main)}setMenuError(t){let e=this.components,n=document.createElement("div");n.classList.add("foodItem__content__error"),n.classList.add("f_h1"),n.innerHTML=t,e.orderMenuCategoryBreakfast.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>',e.orderMenuCategoryMain.innerHTML='<h2 class="f_h2">Main Meals</h2>',e.orderMenuCategorySnack.innerHTML='<h2 class="f_h2">Snacks</h2>',e.orderMenuCategoryDrinks.innerHTML='<h2 class="f_h2">Drinks</h2>',e.orderMenuCategoryBreakfast.appendChild(n),e.orderMenuCategoryMain.appendChild(n),e.orderMenuCategorySnack.appendChild(n),e.orderMenuCategoryDrinks.appendChild(n),this.components=e}updateOrderMenu(t){let e=this.components,n=this;0!=t.length?t.forEach(t=>{let s=new a.a({item:t,parent:n,onUpdate:()=>{n.updateOrder()}});switch(t.c_id){case 1:e.orderMenuCategoryBreakfast.appendChild(s.getOrderItem());break;case 2:e.orderMenuCategoryMain.appendChild(s.getOrderItem());break;case 3:e.orderMenuCategorySnack.appendChild(s.getOrderItem());break;case 4:e.orderMenuCategoryDrinks.appendChild(s.getOrderItem())}}):this.setMenuError("No items in the order menu. Please try order again later!")}updateOrder(){let t=this.state;t.total=0,t.orderItems.forEach(e=>{0!=e.state.quantity&&(t.total+=e.state.total)}),this.components.orderMenuTotal.innerHTML="KSH "+t.total/100,this.state=t}fetchMenu(){let t=this;fetch(`${r.a}/menu`).then(e=>{if(200==e.status)return e.json();t.setMenuError("Failed to fetch menu. Please try again later!")}).then(e=>{void 0!=e&&t.updateOrderMenu(e.content)})}makeOrder(){let t=[];if(this.state.orderItems.forEach(e=>{0!=e.state.quantity&&t.push({id:e.state.item.id,quantity:e.state.quantity})}),0==t.length)return void alert("You have selected no items!");this.state.buttons[0].setStatus(3);let e=this;fetch(`${r.a}/users/orders`,{method:"post",body:JSON.stringify({items:JSON.stringify(t)}),headers:{Authorization:`Bearer ${Object(o.a)()}`,"Content-Type":"application/json"}}).then(t=>{if(201==t.status)return t.json();401==t.status?Object(o.b)({onSuccess:()=>{e.makeOrder()},onFailure:()=>{window.location.href=r.b+"/customer/login"}}):403==t&&(window.location.href=r.b+"/customer/login"),this.state.buttons[0].setStatus(1)}).then(t=>{void 0!=t&&(this.state.buttons[0].setStatus(2),window.location.href=r.b+"/customer/orderHistory")})}}let c=new d,u=new i.default;document.addEventListener("DOMContentLoaded",()=>{u.init(),c.init(),c.fetchMenu()}),e.default=d},6:function(t,e,n){t.exports=n.p+"3e2d929931fcf869c79d01a08df4eddd.png"},8:function(t,e,n){t.exports=n.p+"d47c0b2480371f5b5261e25f5938755a.png"},9:function(t,e,n){t.exports=n.p+"d5d9e2b9c600ebcd4e98640b15ed2b0f.png"}});