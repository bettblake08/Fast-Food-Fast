!function(t){var e={};function n(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(s,a,function(e){return t[e]}.bind(null,a));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s=184)}({1:function(t,e,n){"use strict";n.d(e,"b",function(){return s}),n.d(e,"a",function(){return a});const s="http://localhost:5000",a=`${s}/api/v1`},10:function(t,e,n){"use strict";n.r(e);var s=n(7),a=n.n(s),o=n(4),r=n.n(o),i=n(3),d=n(2),c=n(1),u=n(9),l=n.n(u);e.default=class{constructor(t={}){this._state={headerType:void 0==t.type?"black":t.type,buttons:[],toggleMenu:!1},this._components={}}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}init(){let t=this,e=document.querySelector(".header__logout"),n=document.querySelector(".header__menuButton"),s=document.querySelector(".header__dropDownMenu--disabled"),a=new i.a({class:"btn_1",textClass:"f_button_1",label:"Log Out",parent:t,status:0,action:()=>{t.logOut()}});a.init(),e.appendChild(a.getButton());let o=new Image;o.src=l.a,o.alt="Dropdown menu button",n.appendChild(o),n.addEventListener("click",()=>{t.toggleDropDownMenu()}),this.changeHeaderType(this.state.headerType),this.components.headerMenuButton=n,this.components.headerDropDownMenu=s}changeHeaderType(){let t=document.querySelector(".header__logo"),e=new Image;switch(e.alt="FastFoodFast Logo",this.state.headerType){case"black":e.src=a.a;break;case"white":e.src=r.a}t.appendChild(e)}toggleDropDownMenu(){this.state.toggleMenu=!this.state.toggleMenu,this.state.toggleMenu?(document.querySelector(".header__dropDownMenu__logOut").appendChild(this.state.buttons[0].getButton()),this.components.headerDropDownMenu.classList.replace("header__dropDownMenu--disabled","header__dropDownMenu--active")):(document.querySelector(".header__logOut").appendChild(this.state.buttons[0].getButton()),this.components.headerDropDownMenu.classList.replace("header__dropDownMenu--active","header__dropDownMenu--disabled"))}logOut(){let t=this;fetch(`${c.a}/auth/logout`,{headers:{Authorization:`Bearer ${Object(d.a)()}`}}).then(e=>{switch(e.status){case 200:localStorage.setItem("tokens",JSON.stringify({})),window.location.href=c.b+"/";break;case 401:Object(d.b)({onSuccess:()=>{t.logOut()},onFailure:()=>{window.location.href=c.b+"/customer/login"}});break;case 422:window.location.href=c.b+"/customer/login"}})}}},134:function(t,e,n){t.exports=n.p+"d47c0b2480371f5b5261e25f5938755a.png"},135:function(t,e,n){t.exports=n.p+"d5d9e2b9c600ebcd4e98640b15ed2b0f.png"},136:function(t,e,n){t.exports=n.p+"75bb1dfba7409341bee1f971a19e88cd.png"},137:function(t,e,n){t.exports=n.p+"e707c04257c1833ee8e26bc0499e4256.png"},143:function(t,e,n){"use strict";var s=n(134),a=n.n(s),o=n(135),r=n.n(o),i=n(136),d=n.n(i),c=n(137),u=n.n(c);e.a=class{constructor(t){this._state={total:0,quantity:0,item:t.item};let e=this,n=document.createElement("div"),s=document.createElement("div"),o=new Image,i=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),h=document.createElement("div"),p=document.createElement("div"),m=document.createElement("div"),f=document.createElement("div");switch(t.item.c_id){case 1:o.src=a.a;break;case 2:o.src=r.a;break;case 3:o.src=d.a;break;case 4:o.src=u.a}o.alt=t.item.name,s.classList.add("foodItem__image"),s.appendChild(o),i.classList.add("foodItem__name"),i.classList.add("f_normal"),i.innerHTML=t.item.name,c.classList.add("foodItem__price"),c.classList.add("f_normal"),c.innerHTML="KSH "+t.item.price/100,l.classList.add("foodItem__quantity"),h.classList.add("foodItem__quantity__add"),h.innerHTML="+",p.classList.add("foodItem__quantity__sub"),p.innerHTML="-",m.classList.add("foodItem__quantity__value"),m.classList.add("f_normal"),m.innerHTML="0",h.addEventListener("click",()=>{e.updateQuantity(1,!0),t.onUpdate()}),p.addEventListener("click",()=>{e.updateQuantity(1,!1),t.onUpdate()}),l.appendChild(h),l.appendChild(m),l.appendChild(p),f.classList.add("foodItem__total"),f.classList.add("f_normal"),f.innerHTML="KSH 0",n.classList.add("foodItem"),n.appendChild(s),n.appendChild(i),n.appendChild(c),n.appendChild(l),n.appendChild(f),this._component={main:n,itemImage:s,itemImageImg:o,itemName:i,itemPrice:c,itemQuantity:l,itemQuantityAdd:h,itemQuantitySub:p,itemQuantityValue:m,itemTotal:f};let _=t.parent.state;_.orderItems.push(this),t.parent.state=_}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}updateQuantity(t=1,e=!0){let n=this.state;if(console.log("Updating order : "+n.item.name),e)n.quantity+=t,n.total+=n.item.price;else{if(0==n.quantity)return;n.quantity-=t,n.total-=n.item.price}this.state=n,this.updateOrderDisplay()}updateOrderDisplay(){let t=this.component;t.itemQuantityValue.innerHTML=""+this.state.quantity,t.itemTotal.innerHTML="KSH "+this.state.total/100}getOrderItem(){return this.component.main}}},184:function(t,e,n){t.exports=n(185)},185:function(t,e,n){"use strict";n.r(e);var s=n(143),a=n(3),o=n(1),r=n(2),i=n(10);class d{constructor(){this._state={orderItems:[],buttons:[],total:0};let t=document.createElement("div"),e=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),u=document.createElement("div"),l=document.createElement("div"),h=this;s.classList.add("foodMenu__title"),s.classList.add("f_h1"),s.innerHTML="Order Menu",n.classList.add("foodMenu__topBar"),n.appendChild(s),e.classList.add("foodMenu__content");let p=new a.a({class:"btn_1",textClass:"f_button_2",label:"Make order",parent:this,status:0,action:()=>{h.makeOrder()}});p.init(),r.classList.add("foodMenu__orderBtn"),r.appendChild(p.getButton()),i.classList.add("foodMenu__total"),i.classList.add("f_normal"),i.innerHTML="KSH 0",o.classList.add("foodMenu__bottom"),o.appendChild(r),o.appendChild(i),d.classList.add("foodMenu__category"),d.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>',l.classList.add("foodMenu__category"),l.innerHTML='<h2 class="f_h2">Main Meals</h2>',c.classList.add("foodMenu__category"),c.innerHTML='<h2 class="f_h2">Snacks</h2>',u.classList.add("foodMenu__category"),u.innerHTML='<h2 class="f_h2">Drinks</h2>',e.appendChild(d),e.appendChild(l),e.appendChild(c),e.appendChild(u),t.appendChild(n),t.appendChild(e),t.appendChild(o),this._components={main:t,orderMenuContent:e,orderMenuTopbar:n,orderMenuTitle:s,orderMenuBottom:o,orderMenuOrderButton:r,orderMenuTotal:i,orderMenuCategoryBreakfast:d,orderMenuCategorySnacks:c,orderMenuCategoryDrinks:u,orderMenuCategoryMain:l}}get state(){return this._state}set state(t){this._state=t}get components(){return this._components}set components(t){this._components=t}init(){document.querySelector(".foodMenu").appendChild(this.components.main)}setMenuError(t){let e=this.components,n=`<div class="foodMenu__content__error f_h1">${t}</div>`;e.orderMenuCategoryBreakfast.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>'+n,e.orderMenuCategoryMain.innerHTML='<h2 class="f_h2">Main Meals</h2>'+n,e.orderMenuCategorySnacks.innerHTML='<h2 class="f_h2">Snacks</h2>'+n,e.orderMenuCategoryDrinks.innerHTML='<h2 class="f_h2">Drinks</h2>'+n,this.components=e}updateOrderMenu(t){let e=this,n=[[],[],[],[]];if(0==t.length)return void this.setMenuError("No items in this category. Please add something!");t.forEach(t=>{let a=new s.a({item:t,parent:e,onUpdate:()=>{e.updateOrder()}});n[t.c_id-1].push(a.getOrderItem())});let a='<div class="foodMenu__content__error f_h2">No items in this category.</div>';0==n[0].length?this.components.orderMenuCategoryBreakfast.innerHTML='<h2 class="f_h2">Breakfast Meals</h2>'+a:n[0].forEach(t=>{this.components.orderMenuCategoryBreakfast.appendChild(t)}),0==n[1].length?this.components.orderMenuCategoryMain.innerHTML='<h2 class="f_h2">Main Meals</h2>'+a:n[1].forEach(t=>{this.components.orderMenuCategoryMain.appendChild(t)}),0==n[2].length?this.components.orderMenuCategorySnacks.innerHTML='<h2 class="f_h2">Snacks</h2>'+a:n[2].forEach(t=>{this.components.orderMenuCategorySnacks.appendChild(t)}),0==n[3].length?this.components.orderMenuCategoryDrinks.innerHTML='<h2 class="f_h2">Drinks</h2>'+a:n[3].forEach(t=>{this.components.orderMenuCategoryDrinks.appendChild(t)})}updateOrder(){let t=this.state;t.total=0,t.orderItems.forEach(e=>{0!=e.state.quantity&&(t.total+=e.state.total)}),this.components.orderMenuTotal.innerHTML="KSH "+t.total/100,this.state=t}fetchMenu(){let t=this;fetch(`${o.a}/menu`).then(e=>{if(200==e.status)return e.json();t.setMenuError("Failed to fetch menu. Please try again later!")}).then(e=>{void 0!=e&&t.updateOrderMenu(e.content)})}makeOrder(){let t=[];if(this.state.orderItems.forEach(e=>{0!=e.state.quantity&&t.push({id:e.state.item.id,quantity:e.state.quantity})}),0==t.length)return void alert("You have selected no items!");this.state.buttons[0].setStatus(3);let e=this;fetch(`${o.a}/users/orders`,{method:"post",body:JSON.stringify({items:JSON.stringify(t)}),headers:{Authorization:`Bearer ${Object(r.a)()}`,"Content-Type":"application/json"}}).then(t=>{if(201==t.status)return t.json();401==t.status?Object(r.b)({onSuccess:()=>{e.makeOrder()},onFailure:()=>{window.location.href=o.b+"/customer/login"}}):403==t&&(window.location.href=o.b+"/customer/login"),this.state.buttons[0].setStatus(1)}).then(t=>{void 0!=t&&(this.state.buttons[0].setStatus(2),window.location.href=o.b+"/customer/orderHistory")})}}let c=new d,u=new i.default;document.addEventListener("DOMContentLoaded",()=>{u.init(),c.init(),c.fetchMenu()}),e.default=d},2:function(t,e,n){"use strict";n.d(e,"b",function(){return a}),n.d(e,"a",function(){return o});var s=n(1);function a(t){let e=JSON.parse(localStorage.getItem("tokens"));fetch(`${s.a}/token/refresh`,{method:"GET",headers:{Authorization:`Bearer ${e.refresh_token}`}}).then(e=>{if(201==e.status)return e.json();t.onFailure()}).then(n=>{void 0!=n&&(e.access_token=n.access_token,localStorage.setItem("tokens",JSON.stringify(e)),t.onSuccess())})}function o(){let t=JSON.parse(localStorage.getItem("tokens"));return null==t?"":t.access_token}},3:function(t,e,n){"use strict";e.a=class{constructor(t){this._state={status:t.status},this._props=t;let e=document.createElement("button");e.setAttribute("type","button"),e.classList.add(t.textClass),e.classList.add(this.getButtonClass(t.class,t.status)),e.innerHTML=t.label,e.addEventListener("click",t.action),this._component={main:e}}get state(){return this._state}set state(t){this._state=t}get component(){return this._component}set component(t){this._component=t}get props(){return this._props}set props(t){this._props=t}getButton(){return this.component.main}init(){let t=this.props.parent.state;t.buttons.push(this),this.props.parent.state=t}setStatus(t,e=3e3){let n=this.state,s=this.component,a=this.props,o=this,r=this.getButtonClass(a.class,n.status),i=this.getButtonClass(a.class,t);s.main.classList.replace(r,i),1==t||2==t?setTimeout(()=>{let e=this.getButtonClass(a.class,t),r=this.getButtonClass(a.class,a.status);s.main.classList.replace(e,r),n.status=a.status,o.state=n},e):(n.status=t,o.state=n)}getButtonClass(t,e){switch(e){case 0:return`${t}`;case 1:case 5:return`${t}--fail`;case 2:case 6:return`${t}--success`;case 3:return`${t}--loading`;case 4:return`${t}--warning`}}}},4:function(t,e,n){t.exports=n.p+"4d13aad5b435a3e7bd5832e9199db4a5.png"},7:function(t,e,n){t.exports=n.p+"3e2d929931fcf869c79d01a08df4eddd.png"},9:function(t,e,n){t.exports=n.p+"b889e74d914d77a04de009eac356924d.png"}});